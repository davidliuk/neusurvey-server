<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.neud.neusurvey.user.dao.UserDao">

    <resultMap type="cn.neud.neusurvey.entity.user.UserEntity" id="userMap">
        <result property="id" column="id"/>
        <result property="username" column="username"/>
        <result property="password" column="password"/>
        <result property="role" column="role"/>
        <result property="nickname" column="nickname"/>
        <result property="mobile" column="mobile"/>
        <result property="email" column="email"/>
        <result property="header" column="header"/>
        <result property="gender" column="gender"/>
        <result property="birth" column="birth"/>
        <result property="city" column="city"/>
        <result property="job" column="job"/>
        <result property="sign" column="sign"/>
        <result property="sourceType" column="source_type"/>
        <result property="managedBy" column="managed_by"/>
        <result property="creator" column="creator"/>
        <result property="createDate" column="create_date"/>
        <result property="updater" column="updater"/>
        <result property="updateDate" column="update_date"/>
        <result property="isDeleted" column="is_deleted"/>
        <result property="reserved" column="reserved"/>
    </resultMap>
    <select id="selectByEmail" parameterType="string" resultType="cn.neud.neusurvey.entity.user.UserEntity">
        select * from user where email=#{email};
    </select>
    <select id="pageGroupUser" parameterType="map" resultType="cn.neud.neusurvey.dto.user.UserDTO">
        select  *
        from user where id in
                        (select u.id
                         from user u, member m
                         where u.id = m.user_id and m.group_id = #{group_id})
        order by  #{orderField}  #{order}
        limit #{page}, #{size}
    </select>
    <select id="countGroupUser" parameterType="string" resultType="integer">
        select count(*)
        from member
        where group_id = #{group_id}
    </select>


</mapper>